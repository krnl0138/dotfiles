###
# SWAY CONFIG FILE
###

### DEFAULT VARS
set $mod      Mod1
set $img_lock "~/pics/HURD_Live_CD.png"
set $img_bg   "~/pics/wall/easy.png"
set $wal_bg 'swaymsg -s $SWAYSOCK output VGA-1 bg "$(< "${HOME}/.cache/wal/wal")" fill'

include "$HOME/.cache/wal/colors-sway"

# output LVDS-1 disable
# output VGA-1 pos 0 1920 res 1920x1080 scale 1.0 bg $wallpaper fill
#output VGA-1 pos 0 1920 res 1920x1080 scale 1.0 bg "$(find $HOME/pics/wall | shuf -n 1)" fill

## KEYBOARD SETTINGS
input * {
    repeat_delay 200
    repeat_rate 80
    xkb_layout us,ru
    xkb_options caps:backspace
    xkb_options grp:caps_toggle
}

## AUTOLOAD
exec sxhkd
exec wal -R 
exec_always $wal_bg
exec waybar
exec mako
exec redshift -m wayland
exec swayidle -w \
    timeout 600 'swaylock -s stretch -fli $img_lock' \
    timeout 700 'swaymsg "output * dpms off"' \
        resume 'swaymsg "output * dpms on" && $wal_bg ' \
    before-sleep 'swaylock -s stretch -fli $img_lock'

workspace_auto_back_and_forth yes
focus_follows_mouse no
 
default_border pixel 2
titlebar_border_thickness 0
hide_edge_borders smart
title_align center

### Gaps options
smart_gaps on
smart_borders on
set $gaps_size 5
set $default_inner 15
set $default_outer 0
gaps inner $default_inner
gaps outer $default_outer
# inner gaps
bindsym $mod+equal           gaps inner all plus $gaps_size
bindsym $mod+minus           gaps inner all minus $gaps_size
bindsym $mod+BackSpace       gaps inner all set $default_inner
# outer gaps
bindsym $mod+Shift+equal     gaps outer all plus $gaps_size
bindsym $mod+Shift+minus     gaps outer all minus $gaps_size
bindsym $mod+Shift+BackSpace gaps outer all set $default_outer

# Font for window titles. Used by the bar unless a different font in bar {} 
# font pango:Noto Mono for Powerline 11px
font pango:SFNS Display 11px

# split in horizontal/vertical orientation
bindsym $mod+v split toggle

# Container layout (stacked, tabbed, toggle split)
bindsym $mod+w layout toggle tabbed stacking split
bindsym $mod+e layout toggle split

# Floating options
# toggle tiling / floating
bindsym $mod+Shift+s floating toggle
# change focus between tiling / floating windows
bindsym $mod+s focus mode_toggle
# Use Mouse+$mod to drag floating windows
floating_modifier $mod

# focus the parent/child container
bindsym $mod+a focus parent
bindsym $mod+d focus child

# sticky mode for floating
bindsym $mod+Shift+m mode "sticky" 
mode "sticky" {
	bindsym $mod+m exec i3-msg sticky enable
	bindsym $mod+n exec i3-msg sticky disable
	bindsym $mod+Shift+m mode "default"
	}

# Screenshots
bindsym Print exec grim -t jpeg -q 100 ~/Dropbox/screenshots/"$(date +%Y-%m-%d-%H-%M-%S)".jpeg
bindsym $mod+Print exec grim -g "$(slurp)" ~/Dropbox/screenshots/"$(date +%Y-%m-%d-%H-%M-%S)".jpeg | wl-copy
bindsym Control_L+Print exec grim -g "$(slurp)" - | wl-copy

bindsym $mod+Shift+d border toggle
# bindsym $mod+d exec "rofi -combi-modi drun -show combi -modi combi"
bindsym $mod+Escape exec "dmenu_run -fn 'D2Coding for Powerline-10' -nb '#0269A4' -sb '#000000'"
bindsym $mod+Return exec alacritty
bindsym $mod+q kill
bindsym $mod+f fullscreen toggle
bindsym $mod+Shift+r reload
#bindsym $mod+Shift+c restart

bindsym $mod+Tab focus right


## XF86 bindings
bindsym $mod+F1 reload
bindsym $mod+F2 exec alacritty -e nmtui-connect
bindsym $mod+F3 exec ps -C waybar >/dev/null && killall waybar && waybar || waybar
bindsym $mod+F4 exec --no-startup-id wallpaper.sh
bindsym $mod+F5 exec light -U 5
bindsym $mod+F6 exec light -A 5
bindsym $mod+F7 exec --no-startup-id pulsemixer --list-sinks | grep -q "on Xonar" && pactl set-sink-volume alsa_output.usb-ASUS_Xonar_U7-00.analog-surround-71 -5% || pactl set-sink-volume alsa_output.pci-0000_00_14.2.analog-stereo -5%
bindsym $mod+F8 exec --no-startup-id pulsemixer --list-sinks | grep -q "on Xonar" && pactl set-sink-volume alsa_output.usb-ASUS_Xonar_U7-00.analog-surround-71 +5% || pactl set-sink-volume alsa_output.pci-0000_00_14.2.analog-stereo +5%
bindsym $mod+F9 exec --no-startup-id pactl set-sink-mute compressor-stereo toggle
bindsym $mod+F10 exec --no-startup-id pulsemixer --toggle-mute
bindsym $mod+F11 exec --no-startup-id pulsemixer --change-volume -5
bindsym $mod+F12 exec --no-startup-id pulsemixer --change-volume +5
# bindsym $mod+F12 exec --no-startup-id systemctl suspend

### SCRATCHPADS
bindsym $mod+Control+Tab move scratchpad; move position center
bindsym $mod+Control+grave scratchpad show; move position center
# Luke's dropdown term
    #exec --no-startup-id $TERMINAL -t dropdown
    # bindsym $mod+Tab   [title="^dropdown"] scratchpad show; move position center
    for_window [title="dropdown"] floating enable
    for_window [title="dropdown"] resize set 625 400
    for_window [title="dropdown"] move position center
    for_window [title="dropdown"] move scratchpad
# Grave HTOP scratchpad
    #exec --no-startup-id $TERMINAL -t htopdropdown -e htop
    bindsym $mod+grave [title="^htopdropdown"] scratchpad show; move position center
    for_window [title="htopdropdown"] floating enable
    for_window [title="htopdropdown"] resize set 1920 1060
    for_window [title="htopdropdown"] move position center
    for_window [title="htopdropdown"] move scratchpad

### WINDOWS
# Float window for sxiv
    for_window [instance="sxiv"] floating enable
    for_window [instance="sxiv"] move position 950 50
    for_window [instance="sxiv"] floating_maximum_size -1 x -1
    for_window [instance="sxiv"] resize set 959 700
# Float window for imv
    for_window [instance="imv"]  floating enable
    for_window [instance="imv"]  move position 750 1
    for_window [instance="imv"]  floating_maximum_size -1 x -1
    for_window [instance="imv"]  resize set 640 380
# Float window for feh
    for_window [instance="feh"]  floating enable
    for_window [instance="feh"]  move position 950 50
    for_window [instance="feh"]  floating_maximum_size -1 x -1
    for_window [instance="feh"]  resize set 800 600
# Float window for zotero
    for_window [class="zotero"]  floating enable

# Assignment 
assign [title="chromium"] $ws2
assign [title="telegram-desktop"] $ws3
for_window [class="Chromium" window_role="pop-up"] floating enable
# Task manager 
for_window [title="Task Manager - Chromium"] floating enable
for_window [title="Task Manager - Chromium"] move position center
for_window [title="Task Manager - Chromium"] resize set 800 600
# PavuControl
for_window [app_id="pavucontrol"] floating enable
for_window [app_id="pavucontrol"] move position 1280 0
for_window [app_id="pavucontrol"] resize set 640 480
# Pulsemixer
for_window [title="pulsemixer"] floating enable
for_window [title="pulsemixer"] move position 1235 -25
for_window [title="pulsemixer"] resize set 800 360
# Connection -- bar network change
for_window [app_id="connection"] floating enable
for_window [app_id="connection"] move position 1565 -85
for_window [app_id="connection"] resize set 150 240
# News -- bar newsboat
for_window [app_id="news"] floating enable
for_window [app_id="news"] move position 1235 -25
for_window [app_id="news"] resize set 800 360

# FUN W/ WINDOWS POSITIONS
    bindsym $mod+KP_Home    floating enable;    sticky enable;      resize set 625 400;   move position 0 0 
    bindsym $mod+KP_Begin   floating enable;    sticky enable;      resize set 625 400;   move position center 
    bindsym $mod+KP_Next    floating enable;    sticky enable;      resize set 625 400;   move position 1295 650 
    bindsym $mod+KP_Prior   floating enable;    sticky enable;      resize set 625 400;   move position 1295 0 
    bindsym $mod+KP_End     floating enable;    sticky enable;      resize set 625 400;   move position 0 650 
    bindsym $mod+KP_Left    floating enable;    sticky enable;      resize set 625 400;   move position 0 340
    bindsym $mod+KP_Right   floating enable;    sticky enable;      resize set 625 400;   move position 1295 340
    bindsym $mod+KP_Up      floating enable;    sticky enable;      resize set 625 400;   move position 680 0
    bindsym $mod+KP_Down    floating enable;    sticky enable;      resize set 625 400;   move position 680 650
    bindsym $mod+KP_Delete  floating toggle
    bindsym $mod+KP_Insert  focus mode_toggle

# Launcher mode
set $mode_launcher Launcher
set $n_time 5000
set $apps "vi[F]m \n[N]nn \n[H]top \nnc[P]amixer \n[C]hromium \n[Z]athura \nnews[B]oat \n[T]elegram \n[V]mpk \n[M]endeley \n[G]imp \n[Q]bittorent \n[D]ocear"
bindsym $mod+space mode "$mode_launcher" ; exec notify-send -a "launch" -t 5000 "Launcher" $apps
mode "$mode_launcher" {

    #bindsym r exec notify-send -t $n_time "Ranger has been started"       && $TERMINAL -e ranger       ; mode "default"
    bindsym f exec notify-send -t $n_time "Vifm has been started"          && $TERMINAL -e vifm         ; mode "default"
    bindsym c exec notify-send -t $n_time "Chromium has been started"      && $BROWSER                  ; mode "default"
    bindsym n exec notify-send -t $n_time "NNN has been started"           && $TERMINAL -e nnn          ; mode "default"
    bindsym h exec notify-send -t $n_time "HTop has been started"          && $TERMINAL -e htop         ; mode "default"
    bindsym p exec notify-send -t $n_time "ncPamixer has been started"     && $TERMINAL -e ncpamixer    ; mode "default"
    bindsym z exec notify-send -t $n_time "Zathura has been started"       && zathura                   ; mode "default"
    bindsym b exec notify-send -t $n_time "Newsboat has been started"      && $TERMINAL -e newsboat     ; mode "default"
    bindsym t exec notify-send -t $n_time "Telegram has been started"      && telegram-desktop          ; mode "default"
    bindsym v exec notify-send -t $n_time "VMPK has been started"          && qsynth & vmpk             ; mode "default"
    bindsym m exec notify-send -t $n_time "Mendeley has been started"      && mendeleydesktop           ; mode "default"
    bindsym g exec notify-send -t $n_time "GIMP has been started"          && gimp                      ; mode "default"
    bindsym q exec notify-send -t $n_time "Qbittorrent has been started"   && qbittorrent               ; mode "default"
    bindsym d exec notify-send -t $n_time "Docear has been started"        && docear                    ; mode "default"
    bindsym u exec notify-send -t $n_time "Reference file has been opened" && $TERMINAL -e $EDITOR $BIB ; mode "default"
    
    bindsym Escape     mode "default"
    bindsym Return     mode "default"
    bindsym $mod+space mode "default"
    bindsym space      mode "default"
    }

# Colors stuff
# Defaults colors
set $transparent             #00000000
set $bg-border-color         #4286f4
set $inactive-bg-color       #000000
set $text-color              #f3f4f5
set $inactive-text-color     #ffffff
set $inactive-text-indicator #0000ff
#set $urgent-bg-color		 #E53935
set $urgent-bg-color         #ff00ff
set $childborder             #ff00ff
set $bg-bg-color             #428aff
set $active-text-indicator   #ffff00
set $child_border             #0269A4

# Window colors
# class                 border          backgr.         text         indicator         child_border
client.focused          $color4         $color4         $foreground  $background       $child_border
client.focused_inactive $background     $background     $foreground  $background       $background
client.unfocused        $background     $background     $foreground  $background       $background
client.urgent           $background     $background     $foreground  $background       $background
client.placeholder      $background     $background     $foreground  $background       $text-color
client.background       $background

# Workspaces names
set $ws1 "1"
set $ws2 "2"
set $ws3 "3" 
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

bindsym $mod+n workspace prev
bindsym $mod+period workspace next

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws10
bindsym $mod+m move workspace to output left

# change focus
bindsym $mod+h     focus left
bindsym $mod+j     focus down
bindsym $mod+k     focus up
bindsym $mod+l     focus right
# alternatively, the cursor keys:
bindsym $mod+Left  focus left
bindsym $mod+Down  focus down
bindsym $mod+Up    focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h     move left
bindsym $mod+Shift+j     move down
bindsym $mod+Shift+k     move up
bindsym $mod+Shift+l     move right
# alternatively, the cursor keys:
bindsym $mod+Shift+Left  move left
bindsym $mod+Shift+Down  move down
bindsym $mod+Shift+Up    move up
bindsym $mod+Shift+Right move right

# Shrink layouts with the keyboard
set $shrink_size 10
bindsym $mod+y resize shrink width  $shrink_size px or $shrink_size ppt
bindsym $mod+u resize grow   height $shrink_size px or $shrink_size ppt
bindsym $mod+i resize shrink height $shrink_size px or $shrink_size ppt
bindsym $mod+o resize grow   width  $shrink_size px or $shrink_size ppt
